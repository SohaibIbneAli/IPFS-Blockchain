var Tx = require('ethereumjs-tx')
const Web3 = require('web3')
const web3 = new Web3('https://ropsten.infura.io/v3/b3ceb3d818954622877b1bcd82cd10e6')

const account1 = '0x3462C0C844a374AE295c8F224Ea239cA75E26Cb3';

web3.eth.getTransactionCount(account1, (err, txCount) => {
  //smart contract data
  const data = '0x608060405234801561001057600080fd5b50610260806100206000396000f3006080604052600436106100615763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416634245d48e811461006657806343e08ad1146100cb578063d7738591146100d8578063f31c4c651461011b575b600080fd5b34801561007257600080fd5b5061007b61015c565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156100b757818101518382015260200161009f565b505050509050019250505060405180910390f35b6100d66004356101bc565b005b3480156100e457600080fd5b5061010973ffffffffffffffffffffffffffffffffffffffff600435166024356101dc565b60408051918252519081900360200190f35b34801561012757600080fd5b5061013360043561020c565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b33600090815260208181526040918290208054835181840281018401909452808452606093928301828280156101b257602002820191906000526020600020905b8154815260019091019060200180831161019d575b5050505050905090565b336000908152602081815260408220805460018101825590835291200155565b6000602052816000526040600020818154811015156101f757fe5b90600052602060002001600091509150505481565b60016020526000908152604090205473ffffffffffffffffffffffffffffffffffffffff16815600a165627a7a72305820ebcba5896f28cf71d0843cb4e17bcb6e2acb141f3d9b1f83aa38ee1a844d48a10029'
  
  //create transaction object
  const txObject = {
    nonce: web3.utils.toHex(txCount),
    gasLimit: web3.utils.toHex(1000000),
    gasPrice: web3.utils.toHex(web3.utils.toWei('10', 'gwei')),
    data: data
  }
  //sign the transaction object
  const tx = new Tx(txObject);
  const pp = Buffer.from('1CF9104763200AD1490B51B59F33A569BB9EEDF800BCE27EAF0CFC807DDB9824', 'hex');
  tx.sign(pp);

  const serializedTx = tx.serialize();
  const raw = '0x' + serializedTx.toString('hex');
//broadcast the transaction
  web3.eth.sendSignedTransaction(raw, (err, txHash) => {
    console.log('err:', err, 'txHash:', txHash)
  });
});
